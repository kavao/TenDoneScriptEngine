# TenDone ScriptEngine

Ebitengine（エビテンジン）を使用し、starlarkでロジックを記述するシンプルなECSベースのスクリプトエンジンです

ECSアーキテクチャは、主にゲーム開発で使用されるソフトウェアアーキテクチャパターンで、Entity（エンティティ）、Component（コンポーネント）、System（システム）の3つの要素で構成されています。このパターンは、オブジェクト指向の継承関係による複雑さを避け、柔軟で効率的なゲームオブジェクトの管理を可能にします。

エンティティ（Entity）：ゲーム内の個々のオブジェクトを指し、固有のIDを持つが、具体的なデータや機能は持たない。
コンポーネント（Component）：エンティティに付加されるデータの集合で、位置や速度、描画情報など、特定の属性や状態を表す。
システム（System）：特定のコンポーネントを持つエンティティに対して処理を行う機能群で、ゲームロジックや物理演算などを担当する。
この構造により、データとロジックが明確に分離され、エンティティの振る舞いを動的に変更することが容易になります。また、同じ種類のコンポーネントデータをメモリ上で連続的に配置することで、キャッシュ効率が向上し、大量のオブジェクトを高速に処理できます。 

## 特徴

- ECSアーキテクチャ
- Starlarkスクリプティング
- 解像度設定のサポート（HD, Full HD, SD, モバイル）
- コンポーネントベースの設計
- 物理演算システム
- テキストレンダリング（日本語対応）

## 予定
- シーン管理システム
- UIコンポーネント
- オーディオ管理
- パーティクルシステム
- 衝突判定
- ステートマシン
- アセット管理
  
## 使用方法

1. 実行:
```bash
go run src/main.go
```

2. デバッグモードで実行:
```bash
go run src/main.go -debug
```

## スクリプティング

ゲームロジックはStarlarkスクリプトで記述します。
詳細なAPIリファレンスは[STARLARK_API_REFERENCE.md](docs/STARLARK_API_REFERENCE.md)を参照してください。

### 基本的なスクリプト例:

```python
def init():
    # HD解像度で初期化
    set_screen_resolution("HD")
    
    # プレイヤーの作成
    player_id = create_entity()
    add_component(player_id, "transform", {"x": 100, "y": 100})
    add_component(player_id, "sprite", {"width": 32, "height": 32})

def update():
    # ゲームループの更新処理
    pass
```

## ライセンス

MITライセンス

## サポート

バグ報告や機能要望はIssuesでお願いします。
プルリクエストも歓迎します。

## 開発モード

### デバッグモードの使用

デバッグモードでは、開発用のスクリプトを選択して実行できます：

```bash
go run src/main.go -debug
```

デバッグモードでは以下の機能が利用可能です：
- スクリプトセレクター（複数のテストスクリプトから選択可能）
- デバッグコンソール（`~`キーで表示）
- パフォーマンスモニター

### サンプルスクリプト

`scripts_debug/`ディレクトリには以下のサンプルが用意されています：

1. `basic_sprite.star`
   - 基本的なスプライト表示
   - キーボード入力による移動
   - 簡単なアニメーション

2. `message_test.star`
   - メッセージウィンドウの表示
   - テキストの段階的表示
   - 選択肢の実装

各サンプルの実行方法：
1. デバッグモードで起動
2. スクリプトセレクターから実行したいサンプルを選択
3. 各サンプルのREADMEにしたがって操作 